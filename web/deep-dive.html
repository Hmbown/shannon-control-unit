<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shannon – Technical Deep Dive (CBCES & SCU)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/bell-labs-design.css">
</head>
<body>
  <div class="grid-background"></div>

  <nav class="nav">
    <div class="nav-content">
      <a href="/" class="nav-logo">SHANNON</a>
      <div class="nav-links">
        <a href="/models.html">Models</a>
        <a href="/results.html">Benchmarks</a>
        <a href="/demo.html">Demo</a>
        <a href="/deep-dive.html" class="is-active">Deep Dive</a>
        <a href="/docs.html">Documentation</a>
        <a href="/collaborate.html">Collaborate</a>
        <a href="https://github.com/hmbown/shannon-control-unit">GitHub</a>
      </div>
    </div>
  </nav>

  <main style="max-width: 1100px; margin: 120px auto 60px; padding: 0 20px;">
    <h1>Technical Deep Dive</h1>
    <p class="lead">How Shannon uses compression to detect anomalies (CBCES/NCD) and controls LLM capacity during pre‑training (SCU, rate–distortion).</p>

    <h2>Compression‑Based Detection (CBCES/NCD)</h2>
    <p>We treat compression as a universal proxy for structure. The NCD approximation compares compressed sizes; CBCES uses cross‑entropy vs a baseline as a fast surrogate.</p>
    <div class="code-block" data-lang="python"><pre><code>def ncd(A, B):
    Ca = compress_size(A)
    Cb = compress_size(B)
    Cab = compress_size(A + B)
    return (Cab - min(Ca, Cb)) / max(Ca, Cb)

# CBCES (surrogate): bits/byte(X | baseline)
# If Δbits/byte &gt; τ, flag as anomaly.
</code></pre></div>
    <p>Source of truth metrics power the site: <code>datasets/eval_results.json</code>. No hand‑picked injections in visualizations.</p>

    <h2>SCU for LLM Training (Rate–Distortion)</h2>
    <p>We optimize total description length in bits: <code>L = DataBits + λ(t)·ParamBits</code>. The SCU auto‑tunes <code>λ</code> via a PI controller to hold the parameter‑bit share <code>S = ParamBits / (ParamBits + DataBits)</code> at a target (e.g., 3%).</p>
    <div class="code-block" data-lang="python"><pre><code># MDL objective (in bits)
loss = data_bits + λ * param_bits
S = param_bits / (param_bits + data_bits)
λ ← PI_control(target_S - S)
</code></pre></div>
    <ul>
      <li><b>Data bits</b>: cross‑entropy in bits/token.</li>
      <li><b>Param bits</b>: KL(q||p) to N(0, σ²), amortized per token (MDL).</li>
      <li><b>Controller</b>: PI + EMA + deadband; multiplicative, clamped updates.</li>
    </ul>

    <h3>Repro Commands</h3>
    <div class="code-block" data-lang="bash"><pre><code>pip install -r shannon_llm/requirements_training.txt
python shannon_llm/train_llama_scu.py \
  --mode ce_kl_auto --model_id meta-llama/Llama-3.2-1B \
  --steps 250 --batch_size 1 --target_S 0.03
</code></pre></div>
    <p>Code: <code>shannon_llm/scu_llama.py</code>, <code>shannon_llm/mdl.py</code>. Docs: <code>docs/SHANNON_LLM.md</code>. HF model card: “shannon-control-unit”.</p>

    <h2>Contact</h2>
    <p>We’re looking for research collaborators and design partners in security, observability, and biomed. Investors: please reach out for the deck.</p>
    <p><a class="btn btn-primary" href="mailto:hunter.bown@shannonlabs.dev">Contact Hunter</a>
       <a class="btn" href="/results.html" style="margin-left:.5rem;">Benchmarks</a>
       <a class="btn" href="https://github.com/hmbown/shannon-control-unit" style="margin-left:.5rem;">GitHub</a></p>
  </main>

  <script src="/js/bell-labs.js"></script>
</body>
</html>
